<!DOCTYPE html>
<html lang="zh-Hant">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1">
  <title>è¼¸å…¥å¯†ç¢¼è§£é–</title>

  <!-- å…±ç”¨æ¨£å¼ -->
  <link rel="stylesheet" href="css/style.css">

  <!-- æœ¬é è¿½åŠ æ¨£å¼ -->
  <style>
    body{display:flex;flex-direction:column;align-items:center;padding:2rem;gap:1.2rem;font-family:system-ui}
    #backBtn{
      align-self:flex-start;margin-bottom:.6rem;
      display:inline-flex;align-items:center;gap:.3rem;
      background:#eee;color:#444;border:none;border-radius:4px;
      padding:.4rem .7rem;font-size:.9rem;cursor:pointer;
      transition:background .2s;
    }
    #backBtn:hover{background:#e0e0e0}
    #backBtn svg{width:16px;height:16px;fill:currentColor}
    #hint{white-space:pre-line;font-size:.95rem;line-height:1.5;color:#333;text-align:center;max-width:360px}
    form{display:flex;flex-direction:column;gap:.8rem;width:100%;max-width:280px}
    input,button{padding:.6rem;font-size:1rem;border-radius:4px}
    input{border:1px solid #ccc;text-align:center;letter-spacing:.4em}
    button{border:none;background:#2196f3;color:#fff;cursor:pointer;transition:.2s background}
    button:hover{background:#1b83d9}
  </style>
</head>
<body>
  <!-- ğŸ”¹ æ–°å¢ï¼šå›ä¸Šä¸€é æŒ‰éˆ• -->
  <button id="backBtn" onclick="history.back()">
    <svg viewBox="0 0 24 24"><path d="M15.41 7.41 14 6l-6 6 6 6 1.41-1.41L10.83 12z"/></svg>
    å›åˆ°åœ°åœ–
  </button>

  <h2 id="placeName">è§£é–åœ°é»</h2>
  <div id="hint"></div>

  <form id="codeForm">
    <input id="codeInput"
           placeholder="è¼¸å…¥ 5 ä½æ•¸å­—"
           maxlength="5" pattern="[0-9]{5}" required>
    <button type="submit">ç¢ºå®š</button>
  </form>

  <script type="module">
    import { PLACES } from './js/config.js';
    import { unlock } from './js/storage.js';

    /* 1. å–å¾—ç›®æ¨™åœ°é» --------------------------------------- */
    const targetId = new URLSearchParams(location.search).get('target');
    const place    = PLACES.find(p => p.id === targetId);
    if (!place){
      alert('æœªçŸ¥åœ°é»'); history.back();
    }

    /* 2. é¡¯ç¤ºåç¨±èˆ‡æç¤º ------------------------------------- */
    placeName.textContent = `è§£é–ã€Œ${place.name}ã€`;
    hint.textContent      = place.hint || 'è«‹è¼¸å…¥ 5 ä½å¯†ç¢¼';

    /* 3. é©—è­‰å¯†ç¢¼ ------------------------------------------- */
    codeForm.addEventListener('submit', e => {
      e.preventDefault();
      const val = codeInput.value.trim();
      if (val === place.code){
        unlock(place.id);
        alert('âœ… è§£é–æˆåŠŸï¼');
        location.href = 'game.html';
      }else{
        alert('âŒ å¯†ç¢¼ä¸æ­£ç¢ºï¼Œå†è©¦ä¸€æ¬¡');
      }
    });
  </script>
</body>
</html>